---
title: 'Kaggle 住宅価格予測 単回帰分析してみる'
date: 2020-03-17
tags: ['機械学習']
---

## はじめに
単回帰分析のお勉強がてら, Kaggleのチュートリアル House Prices をやっていきます.  

> House Prices  
> https://www.kaggle.com/c/house-prices-advanced-regression-techniques  

## コンペ内容
### 導入
住宅購入者に地下の天井の高さとかから説明しないよね？  
だけど, このデータセットを使えば寝室の数とかフェンスのあるなしよりも価格交渉にはるかに影響を与えていることがわかるよ.(要翻訳  

### 目標
エイムズというアイオワ州にある都市の住宅のデータが与えられる.  
それらを利用して各住宅の最終価格を予測する.  

## やってみる
### ライブラリのインポート

### 入っているデータ内容の確認
```python
# データの読み込み
train = pd.read_csv('train.csv')
test = pd.read_csv('test.csv')

# データの内容の確認
print(train.columns)
```
!['データの内容'](https://gyazo.com/42d4cc475318a7459d2633e9ce2868cb)  

いっぱいありますね。。(79種類あるみたい  
サイトのデータタブには各データの説明が書かれています.  
ここから気になるデータを一つ選んで単回帰してみたいと思います.  

予測するのは SalePrice なので一番それに関係ありそうなデータを選んでみます.  
ザーッと見た感じやっぱり OverallQualが一番関係ありそうですね..  

> OverallQual：全体的な素材と仕上げの品質(google翻訳)

この値で単回帰してみます.  

### データの分析
とりあえず, OverallQual と SalePrice のデータを取り出します.  
```python
OverallQual = train['OverallQual']
SalePrice = train['SalePrice']

print(OverallQual)
print(SalePrice)

print(type(OverallQual))
print(type(SalePrice))
```

!['タイトル'](https://gyazo.com/e4ed77d9eb3441ad755842042832f7d3)  

DataFrame型のtrainからそれぞれ一列取り出したのでSeries型になっています.  

２つの値の相関行列を見てみましょう.  

相関行列はDataFrame型じゃないと見れないので２つの値をくっつけてDataFrame型にします.  

```python
df = pd.concat([OverallQual, SalePrice], axis=1)
print(df)
```

!['タイトル'](https://gyazo.com/40bbf637e932fa53f673b8b1c3922091)  
concatメソッドを使うとSeries型をくっつけてDataFrame型にしてくれます.  
axis=1は横方向につなげるための引数です.  

```python
print(df.corr())
```

!['タイトル'](https://gyazo.com/829f1bd4f4c2280c1c116ac9fe01e5af)  

相関係数は0.79ぐらいですね.  
正の相関が強いみたいです.

### 単回帰分析
sklearnのLinearRegressionモデルを使って単回帰分析します.  

> LinearRegression  
> https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.LinearRegression.html

```python
X = train[['OverallQual']].values
y = train['SalePrice'].values
reg = LinearRegression()
reg.fit(X, y)
```

X が `[[]]` みたいになっているのはLinearRegressionの引数の形に合わせるためです.  